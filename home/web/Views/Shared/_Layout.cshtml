﻿@using Microsoft.AspNetCore.Hosting
@using Microsoft.Extensions.Configuration

@inject IConfiguration Configuration
@inject IWebHostEnvironment env

<!DOCTYPE html>
<html lang="js">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>@ViewData["Title"] - Nagiyu</title>

    <link rel="stylesheet" href="~/js/dist/assets/buefy.css" />
    @await RenderSectionAsync("Css", required: false)

    @* Font Awesome *@
    <script src="@Configuration["FontAwesome:KitUrl"]" crossorigin="anonymous"></script>

    @if (env.EnvironmentName == "Production")
    {
        <meta name="google-adsense-account" content="@Configuration["GoogleAdSense:Account"]">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=@Configuration["GoogleAdSense:Account"]"
                crossorigin="anonymous"></script>
    }

    <link rel="manifest" href="/manifest.json">

    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script>
        window.OneSignalDeferred = window.OneSignalDeferred || [];

        OneSignalDeferred.push(async function(OneSignal) {
            await OneSignal.init({
                appId: "@Configuration["OneSignal:AppId"]",
            });

            var subscriptionId = await OneSignal.User.PushSubscription.id;

            if (subscriptionId) {
                await fetch(`/api/notification/${subscriptionId}`, {
                    method: "POST"
                });
            }
        });
    </script>
</head>

<body>
    <header id="vue-header"></header>

    <section style="min-height: 75vh;">
        <main class="container">
            @RenderBody()
        </main>
    </section>

    <div id="vue-common"></div>

    <footer id="vue-footer" class="footer"></footer>

    <script type="module" src="~/js/dist/common.js"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>

</html>
